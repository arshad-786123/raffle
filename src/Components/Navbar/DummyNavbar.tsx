import { useEffect, useRef, useState } from 'react';
import mainLogo from '../../assets/second_logo.png'

import whitelogo from '../../assets/main_logo.png'
import { useNavigate } from 'react-router-dom'
import { UserRegister } from '../../Utils/Interface/register.interface';
import { AuthResult, RegisterResponse } from '../../Services/Authentication/login';
import { useSelector, useDispatch } from 'react-redux';
import { increment } from '../../Redux/Counter/counterSlice';
import { checkType } from '../../Services/Authentication/checkType';
import Cookies from "js-cookie";
import { storeGuestUser, storeUser } from '../../Redux/User/userSlice';
import { fetchAccessToken } from '../../Services/Middleware/fetchAccessToken';
import { Dropdown } from 'flowbite-react';
import { clearCart } from '../../Redux/Cart/cartSlice';

const DummyNavbar = () => {


    const userDetails = useSelector((state: any) => state.reducer.user)


    const dispatch = useDispatch()

    const navigate = useNavigate()

    const [isDrawerOpen, setIsDrawerOpen] = useState(false);

    const toggleDrawer = () => {
        setIsDrawerOpen(!isDrawerOpen);
    };

    const drawerRef = useRef<HTMLDivElement>(null); // Specify the type of drawerRef

    useEffect(() => {
        const handleOutsideClick = (event: MouseEvent) => {
            // Check if drawerRef.current is not null and contains the event target
            if (drawerRef.current && !drawerRef.current.contains(event.target as Node)) {
                setIsDrawerOpen(false);
            }
        };

        document.addEventListener('mousedown', handleOutsideClick);

        return () => {
            document.removeEventListener('mousedown', handleOutsideClick);
        };
    }, []);



    const [isExpanded, setIsExpanded] = useState(false);

    const toggleCollapse = () => {
        setIsExpanded(!isExpanded);
    };





    const [userData, setUserData] = useState<AuthResult>()

    useEffect(() => {
        setUserData(userDetails)
        getUserType()
    }, [])


    const getUserType = async () => {
        //    const {type} = await checkType()
        //    if(type!=="Customer"){
        //     navigate("/")
        //    }
    }

    const handleLogout = () => {
        Cookies.remove('accessToken')
        Cookies.remove('refreshToken')
        dispatch(storeUser(""))
        dispatch(storeGuestUser(""))
        dispatch(clearCart())
        navigate("/");
    }




    return (
        <div className='sticky top-0 w-full z-50'>
            <div className='bg-[white] w-full hidden xl:block shadow-lg shadow-white-900'>
                <div className=' w-[94%] m-auto flex items-center justify-between h-20'>
                    <div className='flex items-center gap-32'>
                        <div>
                            <img className='w-36' src={mainLogo} alt="raffly" />
                        </div>
                    </div>
                    <Dropdown inline label="" dismissOnClick={true} renderTrigger={() =>
                        <div className='flex items-center gap-6'>
                            <svg width="21" height="25" viewBox="0 0 21 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.7584 24.8595C9.73404 24.8595 8.75162 24.4526 8.02727 23.7282C7.30293 23.0039 6.896 22.0215 6.896 20.9971C6.896 20.7922 6.97738 20.5957 7.12225 20.4509C7.26712 20.306 7.4636 20.2246 7.66848 20.2246C7.87336 20.2246 8.06984 20.306 8.21471 20.4509C8.35958 20.5957 8.44096 20.7922 8.44096 20.9971C8.44096 21.6117 8.68512 22.2012 9.11973 22.6358C9.55434 23.0704 10.1438 23.3145 10.7584 23.3145C11.373 23.3145 11.9625 23.0704 12.3971 22.6358C12.8317 22.2012 13.0759 21.6117 13.0759 20.9971C13.0759 20.7922 13.1573 20.5957 13.3021 20.4509C13.447 20.306 13.6435 20.2246 13.8484 20.2246C14.0532 20.2246 14.2497 20.306 14.3946 20.4509C14.5394 20.5957 14.6208 20.7922 14.6208 20.9971C14.6208 22.0215 14.2139 23.0039 13.4896 23.7282C12.7652 24.4526 11.7828 24.8595 10.7584 24.8595Z" fill="#232463" />
                                <path d="M19.5568 16.6636C19.2261 16.4432 18.955 16.1446 18.7677 15.7942C18.5804 15.4438 18.4826 15.0525 18.483 14.6551V10.9549C18.4823 9.45251 18.0434 7.98294 17.2202 6.72616C16.3969 5.46937 15.2251 4.47992 13.8481 3.87896V3.23007C13.8481 2.41057 13.5226 1.62463 12.9431 1.04516C12.3636 0.465683 11.5777 0.140137 10.7582 0.140137C9.93869 0.140137 9.15275 0.465683 8.57328 1.04516C7.9938 1.62463 7.66826 2.41057 7.66826 3.23007V3.87896C7.03462 4.15562 6.43991 4.51401 5.89927 4.94499C5.73947 5.07713 5.6387 5.26734 5.61915 5.47378C5.59959 5.68022 5.66284 5.88597 5.79498 6.04578C5.92713 6.20558 6.11734 6.30634 6.32378 6.3259C6.53022 6.34546 6.73597 6.28221 6.89577 6.15006C7.80336 5.4234 8.89753 4.9675 10.0526 4.83475C11.2076 4.70199 12.3767 4.89776 13.4255 5.39956C14.4743 5.90136 15.3602 6.68884 15.9816 7.67154C16.6029 8.65423 16.9344 9.79227 16.9381 10.9549V14.6551C16.9375 15.3074 17.0979 15.9498 17.4052 16.5252C17.7124 17.1006 18.157 17.5912 18.6993 17.9536C18.9233 18.0997 19.0938 18.3145 19.1853 18.5657C19.2769 18.8169 19.2845 19.091 19.207 19.3469C19.1295 19.6028 18.9712 19.8267 18.7557 19.985C18.5402 20.1432 18.2792 20.2274 18.0118 20.2247H3.50457C3.23926 20.2235 2.98128 20.1375 2.76833 19.9792C2.55539 19.821 2.39863 19.5988 2.32097 19.3451C2.24331 19.0914 2.24881 18.8195 2.33667 18.5692C2.42454 18.3188 2.59016 18.1031 2.80933 17.9536C3.35411 17.5931 3.80089 17.103 4.10964 16.5274C4.41838 15.9517 4.57942 15.3084 4.57832 14.6551C4.57832 10.9549 4.40838 9.84253 5.21948 8.20487C5.26412 8.11205 5.29004 8.01134 5.29575 7.90851C5.30147 7.80567 5.28687 7.70271 5.2528 7.60552C5.21873 7.50832 5.16585 7.41879 5.09717 7.34203C5.0285 7.26527 4.94538 7.20279 4.85255 7.15815C4.75973 7.11352 4.65903 7.0876 4.55619 7.08188C4.45336 7.07617 4.3504 7.09076 4.2532 7.12484C4.15601 7.15891 4.06647 7.21179 3.98971 7.28047C3.91296 7.34914 3.85047 7.43226 3.80584 7.52508C2.80161 9.53354 3.03336 10.8931 3.03336 14.6551C3.03434 15.0534 2.93597 15.4457 2.74713 15.7964C2.55829 16.1471 2.28495 16.4451 1.95188 16.6636C1.4553 16.9959 1.07861 17.479 0.877329 18.0417C0.676045 18.6043 0.660807 19.2167 0.833861 19.7886C1.00691 20.3606 1.35911 20.8618 1.83854 21.2185C2.31798 21.5751 2.8993 21.7684 3.49685 21.7697H18.0118C18.6094 21.7684 19.1907 21.5751 19.6701 21.2185C20.1496 20.8618 20.5017 20.3606 20.6748 19.7886C20.8479 19.2167 20.8326 18.6043 20.6313 18.0417C20.43 17.479 20.0534 16.9959 19.5568 16.6636ZM9.21323 3.39229V3.23007C9.23371 2.82032 9.41613 2.43549 9.72036 2.16024C9.871 2.02395 10.047 1.91866 10.2383 1.85039C10.4297 1.78212 10.6326 1.75221 10.8354 1.76235C11.0383 1.7725 11.2372 1.8225 11.4208 1.90952C11.6044 1.99653 11.769 2.11885 11.9053 2.26949C12.0416 2.42012 12.1468 2.59613 12.2151 2.78746C12.2834 2.97878 12.3133 3.18168 12.3032 3.38457C11.2836 3.17446 10.2317 3.17709 9.21323 3.39229Z" fill="#232463" />
                                <circle cx="16.3888" cy="6.70813" r="2.60999" fill="#F66E6A" />
                            </svg>
                            <div className='flex items-center justify-between w-56 border-2 border-[#F2DAE9] py-1 px-3 rounded-lg'>
                                <div className='flex items-center gap-3'>
                                    <svg width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <ellipse cx="23.1136" cy="21.5474" rx="22.3402" ry="21.5" fill="#F2DAE9" />
                                        <g clip-path="url(#clip0_160_72)">
                                            <path d="M22.9635 21.3854C23.9561 21.3854 24.8157 21.0532 25.518 20.3975C26.2204 19.742 26.5764 18.94 26.5764 18.0134C26.5764 17.0871 26.2204 16.285 25.5179 15.6293C24.8155 14.9739 23.956 14.6416 22.9635 14.6416C21.9707 14.6416 21.1114 14.9739 20.4091 15.6294C19.7067 16.2849 19.3506 17.087 19.3506 18.0134C19.3506 18.94 19.7067 19.7422 20.4092 20.3977C21.1116 21.053 21.9711 21.3854 22.9635 21.3854Z" fill="#232463" />
                                            <path d="M29.285 25.4068C29.2648 25.134 29.2238 24.8364 29.1635 24.5222C29.1026 24.2056 29.0242 23.9063 28.9304 23.6328C28.8334 23.35 28.7016 23.0708 28.5386 22.8033C28.3695 22.5256 28.1708 22.2837 27.9479 22.0848C27.7148 21.8766 27.4294 21.7092 27.0993 21.5871C26.7704 21.4657 26.4059 21.4042 26.016 21.4042C25.8629 21.4042 25.7148 21.4628 25.4288 21.6366C25.2528 21.7437 25.0469 21.8676 24.8171 22.0047C24.6206 22.1215 24.3545 22.231 24.0257 22.3301C23.7049 22.427 23.3792 22.4761 23.0577 22.4761C22.7363 22.4761 22.4107 22.427 22.0896 22.3301C21.7611 22.2311 21.4949 22.1216 21.2987 22.0048C21.071 21.869 20.865 21.7451 20.6864 21.6365C20.4007 21.4627 20.2525 21.4041 20.0994 21.4041C19.7094 21.4041 19.345 21.4657 19.0162 21.5872C18.6864 21.7091 18.4009 21.8765 18.1675 22.0849C17.9447 22.284 17.7459 22.5257 17.577 22.8033C17.4142 23.0708 17.2823 23.3499 17.1853 23.6329C17.0916 23.9064 17.0132 24.2056 16.9523 24.5222C16.892 24.836 16.851 25.1337 16.8308 25.4071C16.8109 25.675 16.8008 25.953 16.8008 26.2338C16.8008 26.9646 17.0497 27.5563 17.5405 27.9926C18.0253 28.4231 18.6667 28.6416 19.4468 28.6416H26.6694C27.4494 28.6416 28.0906 28.4233 28.5755 27.9926C29.0664 27.5566 29.3154 26.9649 29.3154 26.2337C29.3152 25.9516 29.3051 25.6734 29.285 25.4068Z" fill="#232463" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_160_72">
                                                <rect width="15" height="14" fill="white" transform="translate(15.5703 14.6416)" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                    {
                                        userData?.user.role === "Business" ?
                                            <p className='text-md font-medium '>{userData?.user.businessName}</p>
                                            :
                                            <p className='text-md font-medium '>{userData?.user.firstname} {userData?.user.lastname}</p>
                                    }

                                </div>
                                <svg width="15" height="10" viewBox="0 0 15 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.45749 0.573173L0.0102536 2.01595L7.15712 9.14941L14.304 2.01595L12.8567 0.573173L7.15712 6.2594L1.45749 0.573173Z" fill="black" />
                                </svg>
                            </div>

                        </div>}>
                        <Dropdown.Item onClick={handleLogout}>Logout</Dropdown.Item>
                    </Dropdown>
                </div>
            </div>
            <div className='bg-[white] w-full block xl:hidden'>

                <div className='w-[94%] m-auto flex items-center justify-between h-20'>
                    <div className='flex items-center gap-32'>
                        <div>
                            <img className='w-36' src={mainLogo} alt="raffly" />
                        </div>
                    </div>
                    <div className='flex items-center gap-6'>
                        <div>
                            <svg width="21" height="26" viewBox="0 0 21 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.0441 25.6456C9.01968 25.6456 8.03726 25.2387 7.31292 24.5144C6.58857 23.79 6.18164 22.8076 6.18164 21.7832C6.18164 21.5784 6.26303 21.3819 6.4079 21.237C6.55276 21.0921 6.74925 21.0107 6.95412 21.0107C7.159 21.0107 7.35548 21.0921 7.50035 21.237C7.64522 21.3819 7.72661 21.5784 7.72661 21.7832C7.72661 22.3979 7.97077 22.9873 8.40537 23.4219C8.83998 23.8565 9.42943 24.1007 10.0441 24.1007C10.6587 24.1007 11.2481 23.8565 11.6827 23.4219C12.1174 22.9873 12.3615 22.3979 12.3615 21.7832C12.3615 21.5784 12.4429 21.3819 12.5878 21.237C12.7326 21.0921 12.9291 21.0107 13.134 21.0107C13.3389 21.0107 13.5354 21.0921 13.6802 21.237C13.8251 21.3819 13.9065 21.5784 13.9065 21.7832C13.9065 22.8076 13.4995 23.79 12.7752 24.5144C12.0509 25.2387 11.0684 25.6456 10.0441 25.6456Z" fill="#232463" />
                                <path d="M18.8424 17.4492C18.5118 17.2289 18.2407 16.9302 18.0534 16.5798C17.866 16.2294 17.7682 15.8381 17.7687 15.4408V11.7406C17.7679 10.2382 17.329 8.76859 16.5058 7.5118C15.6826 6.25502 14.5107 5.26556 13.1338 4.6646V4.01572C13.1338 3.19621 12.8082 2.41028 12.2288 1.8308C11.6493 1.25133 10.8633 0.925781 10.0438 0.925781C9.22434 0.925781 8.4384 1.25133 7.85892 1.8308C7.27945 2.41028 6.9539 3.19621 6.9539 4.01572V4.6646C6.32027 4.94127 5.72556 5.29965 5.18491 5.73063C5.02511 5.86278 4.92435 6.05299 4.90479 6.25943C4.88523 6.46587 4.94848 6.67162 5.08063 6.83142C5.21277 6.99122 5.40299 7.09199 5.60943 7.11154C5.81586 7.1311 6.02162 7.06785 6.18142 6.93571C7.08901 6.20904 8.18318 5.75315 9.33822 5.62039C10.4933 5.48763 11.6623 5.6834 12.7111 6.1852C13.7599 6.68701 14.6459 7.47449 15.2672 8.45718C15.8885 9.43987 16.2201 10.5779 16.2237 11.7406V15.4408C16.2231 16.093 16.3836 16.7354 16.6908 17.3108C16.9981 17.8862 17.4426 18.3769 17.985 18.7393C18.2089 18.8853 18.3794 19.1001 18.471 19.3513C18.5625 19.6025 18.5701 19.8767 18.4926 20.1326C18.4152 20.3885 18.2568 20.6123 18.0413 20.7706C17.8258 20.9289 17.5648 21.013 17.2975 21.0104H2.79022C2.5249 21.0092 2.26693 20.9231 2.05398 20.7649C1.84103 20.6066 1.68428 20.3844 1.60661 20.1307C1.52895 19.877 1.53445 19.6051 1.62232 19.3548C1.71018 19.1045 1.8758 18.8888 2.09498 18.7393C2.63975 18.3788 3.08654 17.8887 3.39528 17.313C3.70402 16.7373 3.86506 16.094 3.86397 15.4408C3.86397 11.7406 3.69402 10.6282 4.50513 8.99051C4.54976 8.89769 4.57568 8.79699 4.5814 8.69415C4.58711 8.59131 4.57252 8.48836 4.53845 8.39116C4.50437 8.29396 4.45149 8.20443 4.38282 8.12767C4.31414 8.05091 4.23102 7.98843 4.1382 7.9438C4.04538 7.89916 3.94467 7.87325 3.84184 7.86753C3.739 7.86181 3.63604 7.87641 3.53885 7.91048C3.44165 7.94455 3.35212 7.99744 3.27536 8.06611C3.1986 8.13478 3.13612 8.21791 3.09148 8.31073C2.08725 10.3192 2.319 11.6788 2.319 15.4408C2.31999 15.8391 2.22161 16.2313 2.03277 16.582C1.84393 16.9327 1.5706 17.2308 1.23752 17.4492C0.740943 17.7816 0.364258 18.2647 0.162974 18.8273C-0.0383103 19.3899 -0.0535482 20.0023 0.119505 20.5743C0.292559 21.1462 0.644751 21.6475 1.12419 22.0041C1.60362 22.3608 2.18494 22.554 2.78249 22.5553H17.2975C17.895 22.554 18.4763 22.3608 18.9558 22.0041C19.4352 21.6475 19.7874 21.1462 19.9604 20.5743C20.1335 20.0023 20.1183 19.3899 19.917 18.8273C19.7157 18.2647 19.339 17.7816 18.8424 17.4492ZM8.49887 4.17794V4.01572C8.51936 3.60597 8.70178 3.22114 9.006 2.94588C9.15664 2.80959 9.33265 2.70431 9.52397 2.63604C9.7153 2.56777 9.9182 2.53785 10.1211 2.548C10.324 2.55814 10.5229 2.60815 10.7064 2.69516C10.89 2.78218 11.0546 2.90449 11.1909 3.05513C11.3272 3.20577 11.4325 3.38177 11.5008 3.5731C11.569 3.76443 11.5989 3.96733 11.5888 4.17021C10.5693 3.9601 9.51734 3.96273 8.49887 4.17794Z" fill="#232463" />
                                <circle cx="15.6744" cy="7.49377" r="2.60999" fill="#F66E6A" />
                            </svg>
                        </div>
                        <div className='flex items-center gap-2'>
                            <svg width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <ellipse cx="23.3011" cy="22.1484" rx="22.3402" ry="21.5" fill="#F2DAE9" />
                                <g clip-path="url(#clip0_278_427)">
                                    <path d="M23.151 21.986C24.1436 21.986 25.0032 21.6537 25.7055 20.9981C26.4079 20.3426 26.7639 19.5406 26.7639 18.614C26.7639 17.6877 26.4079 16.8856 25.7054 16.2299C25.003 15.5745 24.1435 15.2422 23.151 15.2422C22.1582 15.2422 21.2989 15.5745 20.5966 16.23C19.8942 16.8855 19.5381 17.6876 19.5381 18.614C19.5381 19.5406 19.8942 20.3427 20.5967 20.9982C21.2991 21.6536 22.1586 21.986 23.151 21.986Z" fill="#232463" />
                                    <path d="M29.4725 26.0076C29.4523 25.7348 29.4113 25.4373 29.351 25.123C29.2901 24.8064 29.2117 24.5071 29.1179 24.2336C29.0209 23.9509 28.8891 23.6717 28.7261 23.4041C28.557 23.1264 28.3583 22.8846 28.1354 22.6856C27.9023 22.4774 27.6169 22.31 27.2868 22.188C26.9579 22.0665 26.5934 22.005 26.2035 22.005C26.0504 22.005 25.9023 22.0636 25.6163 22.2374C25.4403 22.3445 25.2344 22.4684 25.0046 22.6055C24.8081 22.7223 24.542 22.8318 24.2132 22.9309C23.8924 23.0278 23.5667 23.0769 23.2452 23.0769C22.9238 23.0769 22.5982 23.0278 22.2771 22.9309C21.9486 22.8319 21.6824 22.7224 21.4862 22.6056C21.2585 22.4698 21.0525 22.3459 20.8739 22.2373C20.5882 22.0635 20.44 22.0049 20.2869 22.0049C19.8969 22.0049 19.5325 22.0665 19.2037 22.1881C18.8739 22.3099 18.5884 22.4773 18.355 22.6857C18.1322 22.8848 17.9334 23.1265 17.7645 23.4041C17.6017 23.6717 17.4698 23.9508 17.3728 24.2337C17.2791 24.5073 17.2007 24.8064 17.1398 25.123C17.0795 25.4368 17.0385 25.7345 17.0183 26.0079C16.9984 26.2758 16.9883 26.5539 16.9883 26.8347C16.9883 27.5655 17.2372 28.1571 17.728 28.5934C18.2128 29.024 18.8542 29.2424 19.6343 29.2424H26.8569C27.6369 29.2424 28.2781 29.0241 28.763 28.5934C29.2539 28.1574 29.5029 27.5657 29.5029 26.8346C29.5027 26.5525 29.4926 26.2742 29.4725 26.0076Z" fill="#232463" />
                                </g>
                                <defs>
                                    <clipPath id="clip0_278_427">
                                        <rect width="15" height="14" fill="white" transform="translate(15.7578 15.2422)" />
                                    </clipPath>
                                </defs>
                            </svg>
                            <svg width="15" height="10" viewBox="0 0 15 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1.46091 0.675713L0.0136716 2.11849L7.16054 9.25195L14.3074 2.11849L12.8602 0.675712L7.16054 6.36194L1.46091 0.675713Z" fill="black" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    )
}

export default DummyNavbar